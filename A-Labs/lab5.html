<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-A-Labs/lab5">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<link rel="icon" href="/OSL740/img/pwa/icon-512x512.png">
<link rel="manifest" href="/OSL740/manifest.json">
<meta name="theme-color" content="#DA291C">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#DA291C">
<link rel="apple-touch-icon" href="/OSL740/img/pwa/icon-192x192.png">
<link rel="mask-icon" href="/OSL740/img/pwa/icon-512x512.png" color="#DA291C">
<meta name="msapplication-TileImage" content="/OSL740/img/pwa/icon-512x512.png">
<meta name="msapplication-TileColor" content="#DA291C">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">Lab 5 | OSL740 - Administration of Open Source Systems</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://Seneca-ICTOER.github.io//OSL740/A-Labs/lab5"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Lab 5 | OSL740 - Administration of Open Source Systems"><meta data-rh="true" name="description" content="Lab 5 for Students to Complete and Submit"><meta data-rh="true" property="og:description" content="Lab 5 for Students to Complete and Submit"><link data-rh="true" rel="icon" href="/OSL740/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://Seneca-ICTOER.github.io//OSL740/A-Labs/lab5"><link data-rh="true" rel="alternate" href="https://Seneca-ICTOER.github.io//OSL740/A-Labs/lab5" hreflang="en"><link data-rh="true" rel="alternate" href="https://Seneca-ICTOER.github.io//OSL740/A-Labs/lab5" hreflang="x-default"><link rel="stylesheet" href="/OSL740/assets/css/styles.099fe1a9.css">
<link rel="preload" href="/OSL740/assets/js/runtime~main.e8ac8b46.js" as="script">
<link rel="preload" href="/OSL740/assets/js/main.90f2afc0.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/OSL740/"><div class="navbar__logo"><img src="/OSL740/img/logo.svg" alt="Seneca College" class="themedImage_ToTc themedImage--light_HNdA"><img src="/OSL740/img/logo-dark.svg" alt="Seneca College" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">OSL740 - Administration of Open Source Systems</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/OSL740/">Welcome to OSL740</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/OSL740/weekly-schedule">Weekly Schedule</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/OSL740/A-Labs/lab1">Labs</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OSL740/A-Labs/lab1">Lab 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OSL740/A-Labs/lab2">Lab 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OSL740/A-Labs/lab3">Lab 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OSL740/A-Labs/lab4">Lab 4</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/OSL740/A-Labs/lab5">Lab 5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OSL740/A-Labs/lab6">Lab 6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OSL740/A-Labs/lab7">Lab 7</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OSL740/A-Labs/lab8">Lab 8</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/OSL740/B-Assignments/assignment1">Assignments</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/OSL740/C-ExtraResources/tips">Extra Resources</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/OSL740/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Labs</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Lab 5</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Lab 5: Monitoring and Managing Hard Disk Space, Using LVM, and Scripting</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lab-preparation">Lab Preparation<a class="hash-link" href="#lab-preparation" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="purpose-and-objectives-of-lab-5">Purpose and Objectives of Lab 5<a class="hash-link" href="#purpose-and-objectives-of-lab-5" title="Direct link to heading">​</a></h3><p>The purpose of this lab is to demonstrate how a Linux system administrator can monitor hard disk space availability, and to manage file system size via the Logical Volume Manager (LVM) application. This lab will also demonstrate how to manually mount (i.e. connect) and unmount (disconnect) partitions to file system directories, and demonstrate how to have partitions automatically mounted to directories upon Linux system startup.</p><p><img loading="lazy" alt="Software" src="/OSL740/assets/images/Software-ad583618dfc81275bab4da7518b86eb8.png" width="298" height="287" class="img_ev3q"></p><p>Monitoring Disk Space can fix problems <strong>before</strong> they become a crisis (like running low on hard disk space). We will use LVM to easily resize Linux file-systems.</p><p><img loading="lazy" alt="Crontab" src="/OSL740/assets/images/Crontab-eed842dff3680778b52aea1ec19ad84e.png" width="253" height="260" class="img_ev3q"></p><p>Linux system administrators need to schedule Linux shell scripts and commands (via <strong>crontab</strong>) to automatically run in order to be more productive.</p><p><strong>Main Objectives</strong></p><ul><li>Monitoring Disk Space with utilities such as <strong>ssm list</strong>, <strong>df -h</strong>, and <strong>du -ah</strong>.</li><li>Use the <strong>crontab</strong> utility to automatically schedule the execution of a shell script to &quot;flag&quot; low disk space.</li><li>Use <strong>LVM</strong> to <strong>resize partitions via command-line utilities</strong>.</li><li>Create, partition and format <strong>virtual hard disks</strong> to increase the size of file systems.</li><li>Manually connect and disconnect directories (mount points) to existing partitions (<strong>mount</strong>, <strong>umount</strong>).</li><li>Edit the <strong>/etc/fstab</strong> file to automatically mount partitions upon Linux server boot-up, and test the configuration prior to Linux server boot-up.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="minimum-required-materials">Minimum Required Materials<a class="hash-link" href="#minimum-required-materials" title="Direct link to heading">​</a></h3><ul><li><strong>Solid State Drive</strong></li><li><strong>USB key</strong> (for backups)</li><li><strong>Lab5 Log Book</strong></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="linux-command-reference">Linux Command Reference<a class="hash-link" href="#linux-command-reference" title="Direct link to heading">​</a></h3><p><strong>LVM Information</strong></p><table><thead><tr><th><a href="http://man7.org/linux/man-pages/man8/vgs.8.html" target="_blank" rel="noopener noreferrer">vgs</a></th><th><a href="http://man7.org/linux/man-pages/man8/pvs.8.html" target="_blank" rel="noopener noreferrer">pvs</a></th><th><a href="http://man7.org/linux/man-pages/man8/lvs.8.html" target="_blank" rel="noopener noreferrer">lvs</a></th><th><a href="http://man7.org/linux/man-pages/man8/vgdisplay.8.html" target="_blank" rel="noopener noreferrer">vgdisplay</a></th><th><a href="http://man7.org/linux/man-pages/man8/pvdisplay.8.html" target="_blank" rel="noopener noreferrer">pvdisplay</a></th><th><a href="http://man7.org/linux/man-pages/man8/lvdisplay.8.html" target="_blank" rel="noopener noreferrer">lvdisplay</a></th><th><a href="http://manpages.ubuntu.com/manpages/trusty/man8/ssm.8.html" target="_blank" rel="noopener noreferrer">ssm</a></th></tr></thead></table><p><strong>LVM Management</strong></p><table><thead><tr><th><a href="http://man7.org/linux/man-pages/man8/lvextend.8.html" target="_blank" rel="noopener noreferrer">lvextend</a></th><th><a href="http://man7.org/linux/man-pages/man8/lvcreate.8.html" target="_blank" rel="noopener noreferrer">lvcreate</a></th><th><a href="http://man7.org/linux/man-pages/man8/lvreduce.8.html" target="_blank" rel="noopener noreferrer">lvreduce</a></th><th><a href="http://man7.org/linux/man-pages/man8/pvcreate.8.html" target="_blank" rel="noopener noreferrer">pvcreate</a></th><th><a href="http://man7.org/linux/man-pages/man8/vgextend.8.html" target="_blank" rel="noopener noreferrer">vgextend</a></th></tr></thead></table><p><strong>Miscellaneous</strong></p><table><thead><tr><th><a href="http://man7.org/linux/man-pages/man8/mount.8.html" target="_blank" rel="noopener noreferrer">mount</a></th><th><a href="http://man7.org/linux/man-pages/man8/umount.8.html" target="_blank" rel="noopener noreferrer">umount</a></th><th><a href="http://man7.org/linux/man-pages/man1/df.1.html" target="_blank" rel="noopener noreferrer">df</a></th><th><a href="http://man7.org/linux/man-pages/man1/du.1.html" target="_blank" rel="noopener noreferrer">du</a></th><th><a href="http://man7.org/linux/man-pages/man1/awk.1p.html" target="_blank" rel="noopener noreferrer">awk</a></th><th><a href="http://tldp.org/HOWTO/Partition/fdisk_partitioning.html" target="_blank" rel="noopener noreferrer">fdisk</a></th><th><a href="http://www.cyberciti.biz/faq/howto-format-create-linux-filesystem/" target="_blank" rel="noopener noreferrer">mkfs</a></th><th><a href="http://man7.org/linux/man-pages/man5/fstab.5.html" target="_blank" rel="noopener noreferrer">/etc/fstab</a></th><th><a href="http://code.tutsplus.com/tutorials/scheduling-tasks-with-cron-jobs--net-8800" target="_blank" rel="noopener noreferrer">Using crontab</a></th></tr></thead></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="investigation-1-monitoring-hard-disk-space">Investigation 1: Monitoring Hard Disk Space<a class="hash-link" href="#investigation-1-monitoring-hard-disk-space" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-1-hard-disk-space-utilities">Part 1: Hard Disk Space Utilities<a class="hash-link" href="#part-1-hard-disk-space-utilities" title="Direct link to heading">​</a></h3><p>Another essential duty of a Linux system administrator is to anticipate problems and take preventative measures to avoid computer system problems before they occur. An example would be to periodically monitor hard disk space in order to make adjustments before it impacts on system performance.</p><p>Therefore, we are going to learn in this section how to monitor disk space activity to help take corrective action.</p><p><img loading="lazy" alt="Disk Usage" src="/OSL740/assets/images/Disk_usage-773714d42a001a7c75336b072280b450.png" width="691" height="287" class="img_ev3q"></p><p>The <strong>df</strong> and <strong>du</strong> commands are useful tools for Linux system administrators to flag disk space issues and investigate their causes.</p><p><strong>Perform the following steps:</strong></p><ol><li>Launch your <strong>c7host</strong> and <strong>centos2</strong> VMs.</li><li>Switch to your <strong>centos2</strong> machine.</li><li>Open a terminal.</li><li>Issue the command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">df</span><span class="token plain"> -h</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="5"><li>Note the disk space usage for the <strong>/</strong> and <strong>/home</strong> partitions.</li><li>If a partition is running out of available space, the Linux System Administrator can reallocate space among partitions or add another disk and grow the file system. The administrator can also investigate the cause of low disk space. Two examples immediately come to mind: excessive use of space from users, and potential penetration from hackers.</li><li>To investigate excessive disk usage by regular users, you can obtain a total amount of disk usage for that user by issuing the command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">du</span><span class="token plain"> -ha ~</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">username</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">more</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="8"><li>If there is a recurring space usage problem with regular users, the Linux system administrator can impose quotas (caps on disk usage). This method is not taught in this course.</li><li>The methods to monitor potential penetration to a Linux system are too numerous, and are taught in other courses (for example: SEC520). One method of monitoring potential penetration is use the find command (Note that <strong>find</strong> relies on the permissions of the user currently running it. Compare the results of running this command with and without sudo):</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">find</span><span class="token plain"> -P / -size +100000k</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="10"><li>The next section will apply some of these tools we have discussed into a shell script and crontab entry to periodically monitor and contact the system administrator of potential disk space issues (before they become a serious problem).</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-2-using-crontab-to-automatically-alert-system-administrator-of-low-hard-disk-space">Part 2: Using crontab to Automatically Alert System Administrator of Low Hard Disk Space<a class="hash-link" href="#part-2-using-crontab-to-automatically-alert-system-administrator-of-low-hard-disk-space" title="Direct link to heading">​</a></h3><p>This section focuses on how to automatically run shell scripts without the Linux system administrator being there to issue that shell script. It would be highly unlikely to expect a system administrator to stay up late (eg. 2 a.m.) to manually run a shell script to terminate processes or to re-boot Linux servers. Database files (tables) are used to provide instructions on how frequent shell scripts or commands can be run.</p><p>The <strong>cron</strong> daemon is used to refer to these shell scripts (or other commands or programs) and to run them on a pre-determined basis. The term <strong>cron</strong> comes from the old word <strong>chronograph</strong> meaning a special type of watch (actually a <em>stop-watch</em>) to help monitor and schedule routine tasks.</p><p><strong>Please review these <a href="/OSL740/C-ExtraResources/bash-shell-scripting-tips">Bash Shell Scripting Tips</a> before proceeding with the following steps</strong></p><p><strong>Perform the following steps:</strong></p><ol><li>Perform this section in your <strong>c7host</strong> machine</li><li>Change to your <strong>bin</strong> directory.</li><li>Download the following shell script by issuing the following command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> https://osl740.github.io/labs/monitor-disk-space.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="4"><li>Try to understand what this script does (refer to man pages for the <strong>awk</strong> command), and then run the script with elevated permissions.</li><li>Give execute permissions and run this shell script. This script is supposed to notify the root user by email if there are any potential partition size issues.</li><li>Issue the follow command: </li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> mail -u root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>If you get an error, install email by issuing the command:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yum </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> mailx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Check to see if there are any mail messages. If there are mail messages, they do not relate to this script execution. Remove all mail messages by typing d immediately followed by a mail message number range (eg. to remove all messages. For example, if there are 5 messages, type <strong>d1-5</strong> and then press <strong>ENTER</strong> and enter <strong>q</strong> to exit the mail application).</li></ul><ol start="7"><li>Edit the <strong>monitor-disk-space.py</strong> script, and set the <code>ALERT=90</code> value to <code>ALERT=10</code>. Then save your editing session, and re-run this script.</li><li>Run the <strong>mail</strong> command. Do you have a mail message? Enter the mail message number to view the message. If there is a message, what is the purpose of this message?</li><li>Exit from the mail command.</li><li>The script as it is currently written will send the email to root, but we won&#x27;t be logged in as root most of the time. Change the ADMIN variable in the script to your own username.</li><li>Run the script again and make sure the email message gets delivered to your normal user.</li></ol><p>In order to automatically run the above-mentioned script periodically, you use the scheduler in Linux called <strong>crontab</strong>. The term crontab stands for <strong>Chronograph Tables</strong>, where a chronograph is the old term for a timepiece (the forerunner of the modern stop-watch). You can run the crontab command to schedule commands and shell script to be run in a number of different ways.</p><ol start="12"><li>Quickly view the tutorial about the <a href="http://code.tutsplus.com/tutorials/scheduling-tasks-with-cron-jobs--net-8800" target="_blank" rel="noopener noreferrer">Using crontab</a> file to understand the purpose of this file and how to basically set up a schedule to run a shell script.</li><li>Issue the following command to setup a crontab entry for root:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">crontab</span><span class="token plain"> -e</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="14"><li>Enter the following line in order to run at 6:00 on the first day of every month:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> * * /home/</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">YOURUSERNAME</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/bin/monitor-disk-space.py </span><span class="token comment" style="color:#999988;font-style:italic">#Runs first day of each month (6:00 am)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Note: Make sure you put your own username in that entry.</li></ul><ol start="15"><li><strong>Save</strong> the crontab entry.</li><li>Confirm that the entry was properly saved by issuing the following command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">crontab</span><span class="token plain"> -l</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Answer INVESTIGATION 1 observations / questions in your lab log book.</strong></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="investigation-2-managing-hard-disk-space-using-lvm">Investigation 2: Managing Hard Disk Space Using LVM<a class="hash-link" href="#investigation-2-managing-hard-disk-space-using-lvm" title="Direct link to heading">​</a></h2><p>An application called <strong>LVM</strong> is a very useful tool for Linux system administrators to easily manage file systems, in some cases, even when the computer system is running!</p><p><strong>LVM (Logical Volume Management)</strong> is used to manage hard disk drives / partitions for Linux and Unix systems. LVM provides more flexibility than just partitioning hard disks. <strong>Volume Groups</strong> are areas used to define <strong>Physical Volumes</strong> (i.e. hard disks, disk partitions, or other forms of storage devices). <strong>Logical Volumes</strong> are then used to relate directories (mount points) to a specific physical volume or for a &quot;range&quot; or &quot;span&quot; of physical volumes.</p><p>LVM allows more flexibility and growth potential for Linux systems (for example, having Logical volumes span multiple hard disks). CentOS uses LVM by default upon installation. Other Linux distributions may provide the capacity to install LVM.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-1-managing-file-system-size-with-existing-hard-drive">Part 1: Managing File System Size with Existing Hard Drive<a class="hash-link" href="#part-1-managing-file-system-size-with-existing-hard-drive" title="Direct link to heading">​</a></h3><p>We will now use LVM in order to grow and reduce our file system, using extra unallocated space on our existing (default) virtual hard disk for our centos2 VM.</p><p><img loading="lazy" alt="Ssm" src="/OSL740/assets/images/Ssm-b324e192cc2f91a9ed6c88a8f6cc0803.png" width="1024" height="706" class="img_ev3q"></p><p>Graphical programs like <strong>system-config-lvm</strong> are <strong>deprecated</strong>, and no longer come bundled with Centos. There are other graphical LVM programs, but are for the KDE desktop environment as opposed to Gnome. Command-line tools such as <strong>ssm</strong> (System Storage Manager), <strong>fdisk</strong>, <strong>mkfs</strong>, <strong>pvcreate</strong>, <strong>lvextend</strong>, and <strong>lvreduce</strong> are sufficient to resize file systems when using LVM.</p><p><strong>Perform the following steps:</strong></p><ol><li>Remain in your <strong>centos2</strong> VM for this section.</li><li>Issue the command: </li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> /dev/vd*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>NOTE</strong>: If nothing displays, issue the command: <strong>sudo ls /dev/sd<!-- -->*</strong> and use that device pathname <strong>/dev/sda</strong> instead, and notify your instructor when about to run your lab5-check.bash shell script at the end of this lab.</li></ul><ol start="3"><li>Issue the following command to install the <strong>ssm</strong> command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> yum </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> system-storage-manager</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="4"><li>Issue the command: </li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> ssm list</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Take a few moments to note the volume group, physical volume and logical volume sections of the command output.</li></ul><ol start="5"><li>Compare this output from the ssm command with these other lvm commands: </li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> lvs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> pvs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> vgs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Which method do you prefer to use?</li></ul><ol start="6"><li>Check to see if there is any remaining space on your existing hard disk. Can you see any?</li><li>You can create a partition by using the fdisk command. Issue the following command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fdisk</span><span class="token plain"> /dev/vda</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>(or fdisk /dev/sda if there is no /dev/vda).</li></ul><ol start="8"><li>At the <strong>fdisk</strong> prompt, issue the command: <code>p</code>. What does this do?</li><li>Now issue the commands <code>n</code> (new partition), <code>p</code> (primary partition), <code>3</code> (i.e. next available partition number). When prompted for initial block, press <strong>enter</strong> to accept the default beginning block, and type: <code>+3G</code> at ending block (create a 3GB partition) and press <strong>enter</strong>.</li><li>At the fdisk prompt, issue the command <code>p</code> to review the partition information.</li><li>Enter the command <code>w</code> to save partition table and exit (read the WARNING message).</li></ol><p><strong>You MUST reboot your centos2 VM:</strong> You MUST now reboot your centos2 VM before proceeding!</p><ol start="12"><li>You <strong>must restart</strong> your centos2 VM to allow changes to take effect.</li><li>Verify that you created this partition by issuing the following command: </li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fdisk</span><span class="token plain"> -l /dev/vda</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="14"><li>Re-issue the <strong>ssm list</strong> command. Do you see a new /dev/vda3 partition under Physical Volumes?</li><li>To add the newly created partition, you need to add it into LVM to be used. Issue the following command to add the partition into LVM:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> pvcreate /dev/vda3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>(or <em>pvcreate /dev/sda3</em> ) (enter <strong>y</strong> to proceed - ignore warning)</li></ul><p><strong>Check your VG name</strong></p><p>Run <strong>vgs</strong> to determine your Volume Group name. If it is just <strong>centos</strong> or <strong>cl</strong>, replace <strong>centos_centos2</strong> with <strong>centos</strong> or <strong>cl</strong> for the rest of the following commands in this lab. Do <strong>NOT</strong> try to rename your volume group.</p><ol start="16"><li>Issue the following command to add your new-created and formatted partition called /dev/vda3 to your volume group:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> vgextend centos_centos2 /dev/vda3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="17"><li>Create a new logical volume by issuing the following command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> lvcreate -L 2G -n archive centos_centos2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="18"><li>Format your newly-created partition by issuing the command: </li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mkfs</span><span class="token plain"> -t ext4 /dev/centos_centos2/archive</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="19"><li>Issue the <strong>ssm list</strong> command to view the new physical volume and logical volume information.</li></ol><p><strong>Pay attention to syntax</strong></p><p>Note that the prefixed &quot;+&quot; or &quot;-&quot; in lvextend and lvreduce will add or subtract from the current size. Omitting these prefixes will <strong>set</strong> the LV size to what you specified.</p><ol start="20"><li>Reduce the file-size by issuing the command: </li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> lvreduce -r -L -0.5G centos_centos2/archive</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="21"><li>Issue the <strong>ssm list</strong> command to verify.</li><li>Increase the file-size by issuing the command: </li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> lvextend -r -L +1G centos_centos2/archive</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="23"><li>Issue the <strong>ssm list</strong> command to verify.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-2-adding-additional-virtual-hard-drives">Part 2: Adding Additional Virtual Hard Drives<a class="hash-link" href="#part-2-adding-additional-virtual-hard-drives" title="Direct link to heading">​</a></h3><p>What if your have noted while monitoring disk space, that you starting to run-out of space on your <strong>home</strong> file-system, although you <strong>do NOT have any available space on your current hard disk</strong>? You could obtain an additional hard-drive. We can <strong>add a new virtual hard-drive</strong> (which will serve as a physical volume to the volume group), and extend the <strong>home</strong> logical volume to make use of the new available space. Creating virtual hard drives is not only inexpensive, but a great way for students to learn now to simulate growing the size of the file system!</p><p><img loading="lazy" alt="Add Virtual Disk" src="/OSL740/assets/images/Add_virtual_disk-9ea3ce4c1b80d74a3e5d06530de872f3.png" width="839" height="682" class="img_ev3q"></p><p>You can add virtual hard disks for a VM by changing to the Details section for the VM (as opposed to console), click Add Hardware, fill information in the Add New Virtual Hardware dialog box and clicking Finish. <strong>Notice that I have my original storage in the background so I know what type of disk to select for this second device. They should match</strong>.</p><p><strong>Perform the following steps:</strong></p><ol><li>Remain in your <strong>centos2</strong> VM for this section.</li><li>Run the following commands and make note of the output of the commands:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> /dev/vd*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> ssm list</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">df</span><span class="token plain"> -h</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Record the size of the volume group and the amount of free space</li><li>At the top of your KVM window for <strong>centos2</strong>, click the <strong>view</strong> menu and change view from <strong>Console</strong> to <strong>Details</strong>.</li><li>At the bottom left-hand corner, click <strong>Add Hardware</strong> and add a new storage device of <strong>2GBs</strong>, make sure the <strong>Bus type</strong> is selected <strong>using the same type as your first drive that&#x27;s already there</strong>. If your first drive is SATA, IDE, or VirtIO, select that.</li><li>Click the <strong>VM</strong> menu again, and return to the <strong>console</strong> view to access your centos2 VM display.</li><li>Issue the command: </li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> /dev/vd*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>what has changed?</li></ul><ol start="8"><li>Use <strong>fdisk</strong> (<em>refer to how to use in Part 1</em>) to create a new single <strong>primary</strong> partition for <strong>/dev/vdb</strong> that fills the <em>entire</em> disk, save partition table (accepting default prompts would work and <strong>type w to write your changes</strong>!), restart your <strong>centos2</strong> VM.</li><li>Format your new <em>vdb1</em> partition with file type: <strong>ext4</strong></li><li>Now we&#x27;ll make the new device a <strong>physical volume</strong>, add it to the <strong>volume group</strong> by issuing the following commands:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> pvcreate /dev/vdb1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>(enter <strong>y</strong> to proceed - ignore warning)</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> vgextend centos_centos2 /dev/vdb1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>NOTE</strong>: If you experience an error message, issue the <strong>sudo ssm list</strong> command, and check the <strong>volume group name</strong> under the &quot;<strong>pool</strong>&quot; section. If the volume group name is different than <strong>centos_centos2</strong>, then use that volume group name for all remaining commands that use &quot;centos_centos2&quot;</li></ul><ol start="11"><li>Re-issue the <strong>sudo ssm list</strong> command to see if there is any change.</li><li>Issue the following command to extend the logical volume for the home file-system: </li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> lvextend -r centos_centos2/home --size +2G</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="13"><li>Record the size of the volume group and the amount of free space. What has changed and what caused those changes?</li><li>Issue the <strong>sudo ssm list</strong> command. Note that your home file-system is now 2GB bigger, and you have not even rebooted your machine since you used fdisk to create a partition!</li><li><strong>Reboot</strong> your centos2 VM</li><li>Record the LVM Management commands in your lab log-book.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-3-manually--automatically-mount-partitions">Part 3: Manually &amp; Automatically Mount Partitions<a class="hash-link" href="#part-3-manually--automatically-mount-partitions" title="Direct link to heading">​</a></h3><p>We take for granted that a file-system must be mounted (for example, the root partition) in order for a Linux system to be usable upon system start-up. We need to learn how to do this manually by editing or adding an entry in the file system table (<strong>/etc/fstab</strong>). This file contains entries to mount various file systems automatically upon start-up of the Linux system.</p><p><img loading="lazy" alt="Mount" src="/OSL740/assets/images/Mount-62e8a23f5188445a30063dbb135125dd.png" width="1012" height="258" class="img_ev3q"></p><p>Using the <strong>mount</strong> command with no arguments displays file-systems that are already mounted. The Linux system administrator can use the <strong>mount</strong> and <strong>umount</strong> commands to connect and disconnect different partitions from the file-system to perform maintenance.</p><p>The Linux system administrator also has the ability to manually <strong>mount</strong> (connect) and <strong>un-mount</strong> (disconnect) partitions in order to perform maintenance on the file system (for example, un-mounting the <strong>/home</strong> partition to install software and prevent users from logging in during that process).</p><p><strong>Perform the following steps:</strong></p><ol><li>Perform this part in your <strong>centos2</strong> VM.</li><li>Issue the following command to create a mount-point (directory to connect /dev/dva3 partition to):</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> /archive</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Issue the following command to mount the partition:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mount</span><span class="token plain"> -t ext4 /dev/centos_centos2/archive /archive</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="4"><li>Use the <strong>ls</strong> command to view the contents of the /archive directory. What do you see?</li><li>Issue the <strong>mount</strong> command (without arguments) to confirm it has been mounted.</li><li>Unmount the <strong>/archive</strong> directory by issuing the following commmand: </li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">umount</span><span class="token plain"> /archive</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="7"><li>Issue the <strong>mount</strong> command (without arguments) to confirm it has been unmounted.</li></ol><p>We will now edit the /etc/fstab file in order to have the /dev/vda3 partition automatically mounted to the /archive directory upon system boot-up</p><ol start="8"><li>View the contents of the file-system table <strong>/etc/fstab</strong> by issuing the following command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/fstab</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="9"><li>use <code>sudo vi /etc/fstab</code> to add an entry to automatically mount the /archive directory upon bootup:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/dev/centos_centos2/archive /archive ext4 defaults </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Note: do not alter any of the lines that are already in that file.</li></ul><ol start="10"><li>Issue the command <code>sudo mount -a</code> to see if the entry in <strong>/etc/fstab</strong> works correctly. If there are any errors you must correct them before rebooting your machine.</li><li>Reboot the machine and make sure the <strong>/archive</strong> directory is automatically mounted when the machine boots.</li></ol><p><strong>Answer the INVESTIGATION 2 observations / questions in your lab log book.</strong></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="investigation-3-scripting">Investigation 3: Scripting<a class="hash-link" href="#investigation-3-scripting" title="Direct link to heading">​</a></h2><p>The script used to monitor disk space earlier in the lab is very useful but has a noticeable flaw: You have to manually change the script to modify the percentage of disk space usage that will trigger a warning. It also will only ever send the email to root (unless you manually change the script).</p><ol><li><p>Make a copy of of &quot;monitor-disk-space.py&quot; called <strong>disk-monitor.py</strong> and place it in your user&#x27;s bin directory.</p></li><li><p>Keep the original preamble comments in the script, but add a line indicating that you modified it (and when you did so). Make sure you indicate the change in script name too.</p></li><li><p>Modify the script so that it will use <strong>argparse</strong> to accept command line input from the user for their preferred values for who to send the email to, and what percentage of use is worth sending an email over.</p><ul><li>You may choose the letters for each of these options, just document your choice in the comments in the script.</li><li>Make sure your script keeps the original values as defaults, in case the user doesn&#x27;t specify one of them (i.e. if they don&#x27;t use the option to set who to send the email to, just continue to use root).</li></ul></li><li><p>Test your script with both good and bad data to make sure it works.</p></li><li><p>When you are confident your script works, you are ready to submit the lab.</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lab-5-sign-off-show-instructor">Lab 5 Sign-Off (Show Instructor)<a class="hash-link" href="#lab-5-sign-off-show-instructor" title="Direct link to heading">​</a></h2><p><strong>Time for a new backup!</strong></p><p>If you have successfully completed this lab, make a new backup of your virtual machines as well as your host machine.</p><p><strong>Perform the Following Steps:</strong></p><ol><li>Make certain that your <strong>c7host</strong> and <strong>centos2</strong> VMs are running.</li><li>Switch to your <strong>c7host</strong> machine.</li><li>Open a shell terminal, change to your user&#x27;s <strong>bin</strong> directory.</li><li>Issue the Linux command: </li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> https://osl740.github.io/labs/lab5-check.bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="5"><li>Give the <strong>lab5-check.bash</strong> file execute permissions (for the file owner).</li><li>Run the shell script (with elevated permissions) and if there are any warnings, make fixes and re-run shell script until you receive &quot;congratulations&quot; message.</li><li>Arrange proof of the following on the screen:</li></ol><ul class="contains-task-list containsTaskList_mC6p"><li class="task-list-item"><p><input type="checkbox" checked="" disabled=""> <strong>centos2</strong> VM:</p><ul><li>Output from <strong>sudo ssm list</strong> command.</li><li>Proof that <strong>/archive</strong> has been mounted</li></ul></li><li class="task-list-item"><p><input type="checkbox" checked="" disabled=""> <strong>c7host</strong> Machine:</p><ul><li>Proof of creation of the shell script: <strong>monitor-disk-space.py</strong></li><li>Crontab entry for <strong>root</strong> account</li><li>Run the <strong>lab5-check.bash</strong> script in front of your instructor (must have all  <code>OK</code>  messages)</li></ul></li><li class="task-list-item"><p><input type="checkbox" checked="" disabled=""> <strong>Lab5</strong> log-book filled out.</p></li></ul><ol start="8"><li>Upload a screen of the proof from the previous step, along with the file generated by <strong>lab5-check.bash</strong>, your log book, and your disk-monitior.py script to blackboard.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="practice-for-quizzes-tests-midterm--final-exam">Practice For Quizzes, Tests, Midterm &amp; Final Exam<a class="hash-link" href="#practice-for-quizzes-tests-midterm--final-exam" title="Direct link to heading">​</a></h2><ol><li>What is a VG? PV? LV?</li><li>What is the total size of the &quot;main&quot; VG on your system?</li><li>How do you create an LV?</li><li>How do resize an LV?</li><li>How would you add the disk partition <strong>/dev/sdb7</strong> to your volume group &quot;main&quot;?</li><li>How would you increase the size of the root filesystem by 50 MB?</li><li>How can you determine if a partition has been mounted onto a system?</li><li>How can you unmount an existing partition from the file-system?</li><li>How can you temporarily mount a partition on a file-system?</li><li>How can you permanently mount a partition on a file-system upon boot-up?</li><li>What are the separate elements (fields) of the <strong>/etc/fstab</strong> file?</li><li>Describe the tools that a Linux system administrator have to monitor disk space usage.</li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Seneca-ICTOER/OSL740/tree/main/docs/A-Labs/lab5.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/OSL740/A-Labs/lab4"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Lab 4</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/OSL740/A-Labs/lab6"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lab 6</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#lab-preparation" class="table-of-contents__link toc-highlight">Lab Preparation</a><ul><li><a href="#purpose-and-objectives-of-lab-5" class="table-of-contents__link toc-highlight">Purpose and Objectives of Lab 5</a></li><li><a href="#minimum-required-materials" class="table-of-contents__link toc-highlight">Minimum Required Materials</a></li><li><a href="#linux-command-reference" class="table-of-contents__link toc-highlight">Linux Command Reference</a></li></ul></li><li><a href="#investigation-1-monitoring-hard-disk-space" class="table-of-contents__link toc-highlight">Investigation 1: Monitoring Hard Disk Space</a><ul><li><a href="#part-1-hard-disk-space-utilities" class="table-of-contents__link toc-highlight">Part 1: Hard Disk Space Utilities</a></li><li><a href="#part-2-using-crontab-to-automatically-alert-system-administrator-of-low-hard-disk-space" class="table-of-contents__link toc-highlight">Part 2: Using crontab to Automatically Alert System Administrator of Low Hard Disk Space</a></li></ul></li><li><a href="#investigation-2-managing-hard-disk-space-using-lvm" class="table-of-contents__link toc-highlight">Investigation 2: Managing Hard Disk Space Using LVM</a><ul><li><a href="#part-1-managing-file-system-size-with-existing-hard-drive" class="table-of-contents__link toc-highlight">Part 1: Managing File System Size with Existing Hard Drive</a></li><li><a href="#part-2-adding-additional-virtual-hard-drives" class="table-of-contents__link toc-highlight">Part 2: Adding Additional Virtual Hard Drives</a></li><li><a href="#part-3-manually--automatically-mount-partitions" class="table-of-contents__link toc-highlight">Part 3: Manually &amp; Automatically Mount Partitions</a></li></ul></li><li><a href="#investigation-3-scripting" class="table-of-contents__link toc-highlight">Investigation 3: Scripting</a></li><li><a href="#lab-5-sign-off-show-instructor" class="table-of-contents__link toc-highlight">Lab 5 Sign-Off (Show Instructor)</a></li><li><a href="#practice-for-quizzes-tests-midterm--final-exam" class="table-of-contents__link toc-highlight">Practice For Quizzes, Tests, Midterm &amp; Final Exam</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">OSL740 - Administration of Open Source Systems</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/OSL740/">Contents</a></li><li class="footer__item"><a href="#" id="pwa-button" class="footer__link-item" hidden>Install as an App</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Seneca College.</div></div></div></footer></div>
<script src="/OSL740/assets/js/runtime~main.e8ac8b46.js"></script>
<script src="/OSL740/assets/js/main.90f2afc0.js"></script>
</body>
</html>